import{b as t,w as e,$ as i,o as l,j as a,a as s,q as d,F as u,I as n,t as c,ar as o,a1 as r}from"./index-DyMGAvsR.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";let m=uni.vk;const f=p({data:()=>({form1:{},data:{},item:{},myPosition:{longitude:120.12792,latitude:30.228932}}),onLoad(t){m=uni.vk,this.init(t)},methods:{init(t){this.getList(!0)},pageTo(t){m.navigateTo(t)},add(){let t=this;m.callFunction({url:"template/db_api/pub/add",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e,t.getList()}})},adds(){let t=this;m.callFunction({url:"template/db_api/pub/adds",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e,t.getList()}})},count(){let t=this;m.callFunction({url:"template/db_api/pub/count",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e}})},del(){let t=this;m.callFunction({url:"template/db_api/pub/del",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e,t.getList()}})},getFirstId(){let t,e=this;return e.data&&e.data.rows[0]&&e.data.rows[0]._id&&(t=e.data.rows[0]._id),t},findById(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/findById",title:"请求中...",data:e,success(e){m.alert(JSON.stringify(e)),t.item=e}})},findByWhereJson(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/findById",title:"请求中...",data:e,success(e){m.alert(JSON.stringify(e)),t.item=e}})},getList(t){let e=this;m.callFunction({url:"template/db_api/pub/select",title:t?"请求中...":"",data:{},success(t){e.data=t}})},getList1(){let t=this;m.callFunction({url:"template/db_api/pub/select",title:"请求中...",data:{},success(e){t.data=e,m.alert(JSON.stringify(e)),t.item=e}})},selects(){let t=this;m.callFunction({url:"template/db_api/pub/selects",title:"请求中...",data:{},success(e){t.data=e,m.alert(JSON.stringify(e)),t.item=e}})},sample(){m.callFunction({url:"template/db_api/pub/sample",title:"请求中...",data:{},success(t){t.list&&t.list[0]&&m.alert(JSON.stringify(t.list[0]))}})},update(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/update",title:"请求中...",data:e,success(e){m.alert(JSON.stringify(e)),t.item=e,t.getList()}})},updateById(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/updateById",title:"请求中...",data:e,success(e){m.alert(JSON.stringify(e)),t.item=e,t.getList()}})},updateAndReturn(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/updateAndReturn",title:"请求中...",data:e,success(e){m.alert(`当前money的值：${e.info.money} \n 提示：此为原子操作，可以应用于类似id自增，数字自减等业务。`),t.item=e,t.getList()}})},groupCount(){let t=this,e={_id:t.getFirstId()};m.callFunction({url:"template/db_api/pub/groupCount",title:"请求中...",data:e,success(e){m.alert(JSON.stringify(e.rows)),t.item=e,t.getList()}})},sum(){let t=this;m.callFunction({url:"template/db_api/pub/sum",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e}})},avg(){let t=this;m.callFunction({url:"template/db_api/pub/avg",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e}})},max(){let t=this;m.callFunction({url:"template/db_api/pub/max",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e}})},min(){let t=this;m.callFunction({url:"template/db_api/pub/min",title:"请求中...",success(e){m.alert(JSON.stringify(e)),t.item=e}})},getGeoList(t){let e=this;m.callFunction({url:"template/db_api/pub/geo",title:"请求中...",data:{},success(t){e.data=t}})},calcLocation(t={},e={}){if(null==e.longitude||null==e.latitude)return"";let i={},l=0,a=0,s=e.longitude,d=e.latitude,u=t.longitude,n=t.latitude;return l=Math.sqrt((s-u)*(s-u)+(d-n)*(d-n))/180*Math.PI*63e5,l=l.toFixed(1),a=(l/1e3).toFixed(2),i.str=l>=1e6?"很遥远":l>=1e3?a+" km":l+" m",i.m=l,i.km=a,i},calcLocationFn(t={},e={}){return this.calcLocation(t,e).km}}},[["render",function(p,m,f,_,g,y){const b=i,h=o,F=r;return l(),t(b,{class:"app"},{default:e((()=>[a(h,{"scroll-y":!0,style:{"max-height":"500rpx"}},{default:e((()=>[(l(!0),s(u,null,d(g.data.rows,((i,a)=>(l(),t(b,{key:i._id},{default:e((()=>[n(c(a+1)+": {_id: "+c(i._id.substring(20))+", money: "+c(i.money)+"} 距您 "+c(y.calcLocationFn(i.position,g.myPosition))+" km ",1)])),_:2},1024)))),128))])),_:1}),a(b,{style:{"margin-bottom":"20rpx","font-size":"36rpx"}},{default:e((()=>[n("当前共有: "+c(g.data.total)+" 条记录",1)])),_:1}),a(F,{style:{"margin-left":"50rpx"},onClick:m[0]||(m[0]=t=>y.pageTo("list/list"))},{default:e((()=>[n("查看更多")])),_:1}),a(b,{style:{display:"flex"}},{default:e((()=>[a(F,{onClick:m[1]||(m[1]=t=>y.add())},{default:e((()=>[n("add(添加一条记录)")])),_:1}),a(F,{onClick:m[2]||(m[2]=t=>y.adds())},{default:e((()=>[n("adds(添加多条记录)")])),_:1})])),_:1}),a(F,{onClick:m[3]||(m[3]=t=>y.count())},{default:e((()=>[n("count(获取集合共有多少条记录)")])),_:1}),a(F,{onClick:m[4]||(m[4]=t=>y.del())},{default:e((()=>[n("del(删除集合所有数据)")])),_:1}),a(F,{onClick:m[5]||(m[5]=t=>y.findById())},{default:e((()=>[n("findById(根据id获取一条记录)")])),_:1}),a(F,{onClick:m[6]||(m[6]=t=>y.findByWhereJson())},{default:e((()=>[n("findByWhereJson(根据条件获取一条记录)")])),_:1}),a(b,null,{default:e((()=>[a(F,{onClick:m[7]||(m[7]=t=>y.getList1())},{default:e((()=>[n("select(获取多条数据)")])),_:1}),a(F,{onClick:m[8]||(m[8]=t=>y.selects())},{default:e((()=>[n("selects(万能连表查询)")])),_:1})])),_:1}),a(F,{onClick:m[9]||(m[9]=t=>y.sample())},{default:e((()=>[n("随机获取1条记录（一般用于抽奖）")])),_:1}),a(F,{onClick:m[10]||(m[10]=t=>y.update())},{default:e((()=>[n("update(修改记录)")])),_:1}),a(F,{onClick:m[11]||(m[11]=t=>y.updateById())},{default:e((()=>[n("updateById(修改并返回修改后的数据)")])),_:1}),a(F,{onClick:m[12]||(m[12]=t=>y.updateAndReturn())},{default:e((()=>[n("updateAndReturn(原子操作)")])),_:1}),a(F,{onClick:m[13]||(m[13]=t=>y.groupCount())},{default:e((()=>[n("groupCount(分组count)")])),_:1}),a(b,{style:{display:"flex"}},{default:e((()=>[a(F,{onClick:m[14]||(m[14]=t=>y.sum())},{default:e((()=>[n("sum(取总和值)")])),_:1}),a(F,{onClick:m[15]||(m[15]=t=>y.avg())},{default:e((()=>[n("avg(取平均值)")])),_:1})])),_:1}),a(b,{style:{display:"flex"}},{default:e((()=>[a(F,{onClick:m[16]||(m[16]=t=>y.max())},{default:e((()=>[n("max(取最大值)")])),_:1}),a(F,{onClick:m[17]||(m[17]=t=>y.min())},{default:e((()=>[n("min(取最小值)")])),_:1})])),_:1}),a(F,{onClick:m[18]||(m[18]=t=>y.getGeoList())},{default:e((()=>[n("geo(地理位置 搜索4公里内)")])),_:1}),a(b,null,{default:e((()=>[n(c(JSON.stringify(g.item)),1)])),_:1})])),_:1})}],["__scopeId","data-v-ad43546d"]]);export{f as default};
